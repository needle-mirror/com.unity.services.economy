# Player Inventory

The methods in the PlayerInventory namespace allow you to retrieve and update the player's inventory items. 

These methods will return inventory data for the currently signed in player from the Authentication SDK.

> **All the methods in this namespace can throw an `EconomyException` as described [here](./index.md#EconomyException)**

#### GetInventory

Retrieves the current inventory items associated with the currently signed in player.

When getting items, you can set an optional limit on the number of items to fetch (between 1 and 100 inclusive). This is to help with pagination. The default number is 20.

You can filter the inventory items received using an array of item IDs and/or playerInventoryItem IDs. If you use these filter options then only players items that have the specified configuration item IDs and playerInventoryItem IDs will be returned.

```cs
// Will retrieve the default maximum of 20 items
GetInventoryResult inventoryResult = await Economy.PlayerInventory.GetInventoryAsync();

List<PlayersInventoryItem> listOfItems = inventoryResult.PlayersInventoryItems;

if (inventoryResult.HasNext) {
    inventoryResult.GetNext();
}
List<PlayersInventoryItem> updatedList = inventoryResult.PlayersInventoryItems;

// ... etc
```

Retrieve the first 5 balances for the current user, and then retrieve the next 5.
```cs
GetInventoryResult inventoryResult = await Economy.PlayerInventory.GetInventoryAsync(5);

List<PlayersInventoryItem> listOfItems = inventoryResult.PlayersInventoryItems;

if (inventoryResult.HasNext) {
    GetInventoryResult nextinventoryResult = await inventoryResult.GetNext(5);
}

// ... etc
```

Retrieve only the player's `SWORD` items.
```cs
List<string> inventoryItemIDs = new List<string>() { "SWORD" };

GetInventoryResult inventoryResult = await Economy.PlayerInventory.GetInventoryAsync(inventoryItemIds: inventoryItemIDs);

List<PlayersInventoryItem> listOfItems = inventoryResult.PlayersInventoryItems;

// ... etc
```

These methods return a `GetInventoryResult`. This object handles the pagination for you. 

#### AddInventoryItemAsync

Adds an item to the player's inventory. 

Takes an optional playersInventoryItemId - if null one will be autogenerated. Also takes an optional dictionary of instance data.

Returns a `PlayersInventoryItem` representing the inventory item added to the players inventory.

```cs
Dictionary<string, string> instanceData = new Dictionary<string, string>();
// Add some data here

PlayersInventoryItem createdInventoryItem = await Economy.PlayerInventory.AddInventoryItemAsync("SWORD", "customPlayersInventoryItemID", instanceData);
```

#### DeletePlayersInventoryItemAsync

Deletes an item from a player's inventory.

If a writeLock is provided, it will only delete the item if the writeLock is accepted by the Economy service. If no writelock is provided then the operation will be forced through.

```cs
Economy.PlayerInventory.DeletePlayersInventoryItemAsync("playersInventoryItemID", "writeLock");
// OR
Economy.PlayerInventory.DeletePlayersInventoryItemAsync("playersInventoryItemID");
```

#### UpdatePlayersInventoryItemAsync

Updates an item with new instance data.

Returns the updated players inventory item.

If a writeLock is provided, it will only update the item if the writeLock is accepted by the Economy service. If no writelock is provided then the operation will be forced through.

```cs
object instanceData = new object(); // Replace with your desired instance data

PlayersInventoryItem playersInventoryItem = await Economy.PlayerInventory.UpdatePlayersInventoryItemAsync("playersInventoryItemID", instanceData, "writeLock");
// OR
PlayersInventoryItem playersInventoryItem = await Economy.PlayerInventory.UpdatePlayersInventoryItemAsync("playersInventoryItemID", instanceData);
```

#### PlayersInventoryItemUpdated

This event can be subscribed to in order to be notified when the SDK updates a specific item in the player's inventory.
The subscriber will be passed the playersInventoryItem ID of the item that was updated.

**Note**: This event will only be called for SDK initiated actions (e.g. updating player's inventory, making purchases etc). 
It will _not_ be called for any updates from other devices / service side changes.

```cs
Economy.PlayerInventory.PlayersInventoryItemUpdated += playersInventoryItemID => {
    Debug.Log($"The players inventory item that was updated was {playersInventoryItemID}");
};
```

### GetInventoryResult

A `GetInventoryResult` provides paginated access to the list of players inventory items retrieved. It has the following fields:

- `PlayersInventoryItems`: A `List<PlayersInventoryItem>` with the currently fetched items

It has the following methods:

- `GetNextAsync(int itemsToFetch = 20)`: This method asynchronously fetches more results. It has one optional parameter to limit the amount
of results fetched (this can be between 1 and 100 inclusive, default is 20). It will return a new result, which contains both the original items and
the newly fetched items in it's `PlayersInventoryItems` list. The result will be `null` if there are no more results to fetch.

### PlayersInventoryItem

A `PlayersInventoryItem` represents a single unique item in a player's inventory.
It contains the following fields:

- `PlayersInventoryItemId`: The ID of this unique inventory item in the players inventory
- `InventoryItemId`: The configuration ID of this inventory item
- `InstanceData`: Any instance data associated with this players inventory item. See below for more details.
- `WriteLock`: The current writelock string for this players inventory item
- `Created`: The date this players inventory item was created. It is an `EconomyDate` object (see [here](./index.md#EconomyDate)).
- `Modified`: The date this players inventory item was modified. It is an `EconomyDate` object (see [here](./index.md#EconomyDate)).

It also has the following helper method:

#### GetItemDefinition

This method fetches the configuration of this players inventory item, type of `InventoryItemDefinition`.

```cs
PlayersInventoryItem playersInventoryItem = // ... fetch the players inventory item
InventoryItemDefinition itemDefinition = playersInventoryItem.GetItemDefinitionAsync();
```

### Using InstanceData

InstanceData is used to add custom data for specific items in a player's inventory. It is of type Dictionary<string, object>.

For example, a player's shield may have a durability rating. This could be set and updated using InstanceData:

```
Dictionary<string, object> instanceData = new Dictionary<string, object>();
instanceData.Add("durability", 100);        
     
PlayersInventoryItem updatedItem = await Economy.PlayerInventory.UpdatePlayersInventoryItemAsync("playersInventoryItemId", instanceData); 
```
